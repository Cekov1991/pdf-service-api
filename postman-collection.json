{
  "info": {
    "name": "PDF Service API (v2 - Template Specifications)",
    "description": "PDF generation service with template_specifications format",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "pdf-service-api"
  },
  "item": [
    {
      "name": "Health Check",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response has success field\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData.success).to.be.true;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/api/health",
          "host": ["{{baseUrl}}"],
          "path": ["api", "health"]
        },
        "description": "Health check endpoint to verify the API is running"
      },
      "response": []
    },
    {
      "name": "Generate PDF - Visit Report (Reports Folder)",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response contains PDF data\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData).to.have.property('success');",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.data).to.have.property('base64');",
              "    pm.expect(jsonData.data).to.have.property('mimeType', 'application/pdf');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template_specifications\": {\n    \"folder\": \"reports\",\n    \"id\": \"anamnesis\",\n    \"locale\": \"en\"\n  },\n  \"data\": {\n    \"visit_report\": \"Visit Report\",\n    \"generated_on\": \"Generated on\",\n    \"patient_information\": \"Patient Information\",\n    \"full_name\": \"Full Name\",\n    \"dob\": \"Date of Birth\",\n    \"sex\": \"Sex\",\n    \"unique_master_citizen_number\": \"Citizen Number\",\n    \"phone\": \"Phone\",\n    \"email\": \"Email\",\n    \"generated_at\": \"16/11/2025 14:30\",\n    \"current_date\": \"16/11/2025\",\n    \"patient\": {\n      \"full_name\": \"John Doe\",\n      \"dob\": \"15/05/1985\",\n      \"sex\": \"Male\",\n      \"unique_master_citizen_number\": \"1234567890123\",\n      \"phone\": \"+1 (555) 123-4567\",\n      \"email\": \"john.doe@example.com\"\n    },\n    \"visit\": {\n      \"scheduled_at\": \"16/11/2025 10:30\",\n      \"type\": \"Regular Checkup\",\n      \"status\": \"Completed\",\n      \"reason_for_visit\": \"Annual eye examination\"\n    },\n    \"doctor\": {\n      \"name\": \"Dr. Sarah Johnson\"\n    }\n  },\n  \"options\": {\n    \"format\": \"A4\",\n    \"landscape\": false\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/generate",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "generate"]
        },
        "description": "Generate a PDF from a template in the reports folder with embedded labels"
      },
      "response": []
    },
    {
      "name": "Generate PDF - Visit Report with Locale",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response contains PDF data\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.data.base64).to.exist;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template_specifications\": {\n    \"folder\": \"reports\",\n    \"id\": \"anamnesis\",\n    \"locale\": \"mk\"\n  },\n  \"data\": {\n    \"generated_at\": \"16/11/2025 14:30\",\n    \"current_date\": \"16/11/2025\",\n    \"patient\": {\n      \"full_name\": \"Кирил Атанасоски\",\n      \"dob\": \"15/05/1985\",\n      \"sex\": \"Машки\",\n      \"unique_master_citizen_number\": \"1234567890123\",\n      \"phone\": \"+389 70 123-456\",\n      \"email\": \"kiril@example.com\"\n    },\n    \"visit\": {\n      \"scheduled_at\": \"16/11/2025 10:30\",\n      \"type\": \"Редовен преглед\",\n      \"status\": \"Завршен\",\n      \"reason_for_visit\": \"Годишен очен преглед\"\n    },\n    \"doctor\": {\n      \"name\": \"Д-р Марија Петровска\"\n    }\n  },\n  \"options\": {\n    \"format\": \"A4\",\n    \"landscape\": false\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/generate",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "generate"]
        },
        "description": "Generate a PDF using Macedonian locale translations from locale files (src/locales/mk.json)"
      },
      "response": []
    },
    {
      "name": "Generate Visit Report - Dedicated Endpoint",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"PDF generated successfully\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "    pm.expect(jsonData.data.size).to.be.above(0);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template_specifications\": {\n    \"folder\": \"reports\",\n    \"id\": \"anamnesis\",\n    \"locale\": \"en\"\n  },\n  \"data\": {\n    \"generated_at\": \"16/11/2025 14:30\",\n    \"current_date\": \"16/11/2025\",\n    \"patient\": {\n      \"full_name\": \"Jane Smith\",\n      \"dob\": \"22/08/1990\",\n      \"sex\": \"Female\",\n      \"unique_master_citizen_number\": \"9876543210123\",\n      \"phone\": \"+1 (555) 987-6543\",\n      \"email\": \"jane.smith@example.com\"\n    },\n    \"visit\": {\n      \"scheduled_at\": \"16/11/2025 14:00\",\n      \"type\": \"Follow-up\",\n      \"status\": \"Completed\",\n      \"reason_for_visit\": \"Post-surgery checkup\"\n    },\n    \"doctor\": {\n      \"name\": \"Dr. Michael Chen\"\n    },\n    \"anamnesis\": {\n      \"chief_complaint\": \"Mild discomfort after recent procedure\",\n      \"history_of_present_illness\": \"Patient reports slight discomfort\",\n      \"past_medical_history\": \"Lasik surgery 2 weeks ago\",\n      \"family_history\": \"No significant family history\",\n      \"medications_current\": \"Artificial tears as needed\",\n      \"allergies\": \"None known\",\n      \"therapy_in_use\": \"Post-operative eye drops\",\n      \"other_notes\": \"Healing well, no complications\"\n    }\n  },\n  \"options\": {\n    \"format\": \"A4\",\n    \"landscape\": false\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/visit-report",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "visit-report"]
        },
        "description": "Generate visit report using the dedicated endpoint with anamnesis data"
      },
      "response": []
    },
    {
      "name": "Generate PDF - Root Template",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template_specifications\": {\n    \"id\": \"visit-report\",\n    \"locale\": \"en\"\n  },\n  \"data\": {\n    \"generated_at\": \"16/11/2025 14:30\",\n    \"current_date\": \"16/11/2025\",\n    \"patient\": {\n      \"full_name\": \"Test Patient\",\n      \"dob\": \"01/01/1980\",\n      \"sex\": \"Male\"\n    },\n    \"visit\": {\n      \"scheduled_at\": \"16/11/2025 10:00\",\n      \"type\": \"Consultation\",\n      \"status\": \"Completed\"\n    },\n    \"doctor\": {\n      \"name\": \"Dr. Test Doctor\"\n    }\n  },\n  \"options\": {\n    \"format\": \"A4\",\n    \"landscape\": false\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/generate",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "generate"]
        },
        "description": "Generate PDF from a template in the root templates folder (no folder specified)"
      },
      "response": []
    },
    {
      "name": "Generate PDF - Landscape Format",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template_specifications\": {\n    \"folder\": \"reports\",\n    \"id\": \"anamnesis\",\n    \"locale\": \"en\"\n  },\n  \"data\": {\n    \"generated_at\": \"16/11/2025 14:30\",\n    \"current_date\": \"16/11/2025\",\n    \"patient\": {\n      \"full_name\": \"Wide Format Test\",\n      \"dob\": \"01/01/1980\",\n      \"sex\": \"Male\"\n    },\n    \"visit\": {\n      \"scheduled_at\": \"16/11/2025 10:00\",\n      \"type\": \"Test\",\n      \"status\": \"Completed\"\n    },\n    \"doctor\": {\n      \"name\": \"Dr. Test\"\n    }\n  },\n  \"options\": {\n    \"format\": \"A4\",\n    \"landscape\": true\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/generate",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "generate"]
        },
        "description": "Generate PDF in landscape orientation"
      },
      "response": []
    },
    {
      "name": "Generate from HTML",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Response contains PDF\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.success).to.be.true;",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"html\": \"<!DOCTYPE html><html><head><title>Test PDF</title><style>body { font-family: Arial, sans-serif; padding: 20px; } h1 { color: #4f46e5; }</style></head><body><h1>Test PDF Document</h1><p>This is a test PDF generated from raw HTML.</p><ul><li>Item 1</li><li>Item 2</li><li>Item 3</li></ul></body></html>\",\n  \"options\": {\n    \"format\": \"A4\",\n    \"landscape\": false,\n    \"margin\": {\n      \"top\": \"20mm\",\n      \"right\": \"20mm\",\n      \"bottom\": \"20mm\",\n      \"left\": \"20mm\"\n    }\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/from-html",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "from-html"]
        },
        "description": "Generate PDF from raw HTML string"
      },
      "response": []
    },
    {
      "name": "Generate from URL",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"url\": \"https://example.com\",\n  \"options\": {\n    \"format\": \"A4\",\n    \"landscape\": false\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/from-url",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "from-url"]
        },
        "description": "Generate PDF from a URL"
      },
      "response": []
    },
    {
      "name": "Error - Missing template_specifications",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400\", function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test(\"Error message mentions template_specifications\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.error).to.include('template_specifications');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"data\": {\n    \"patient\": {\n      \"full_name\": \"Test\"\n    }\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/generate",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "generate"]
        },
        "description": "Test error handling when template_specifications is missing"
      },
      "response": []
    },
    {
      "name": "Error - Missing template ID",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "pm.test(\"Status code is 400\", function () {",
              "    pm.response.to.have.status(400);",
              "});",
              "",
              "pm.test(\"Error mentions ID is required\", function () {",
              "    var jsonData = pm.response.json();",
              "    pm.expect(jsonData.error).to.include('id');",
              "});"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"template_specifications\": {\n    \"folder\": \"reports\"\n  },\n  \"data\": {\n    \"patient\": {\n      \"full_name\": \"Test\"\n    }\n  }\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/api/pdf/generate",
          "host": ["{{baseUrl}}"],
          "path": ["api", "pdf", "generate"]
        },
        "description": "Test error handling when template ID is missing"
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    }
  ]
}

